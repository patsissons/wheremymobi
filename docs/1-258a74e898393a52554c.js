(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{298:function(e,t,n){"use strict";n.r(t),n.d(t,"graphql",function(){return p}),n.d(t,"StaticQueryContext",function(){return f}),n.d(t,"StaticQuery",function(){return m});var o=n(0),r=n.n(o),a=n(3),i=n.n(a),s=n(159),c=n.n(s);n.d(t,"Link",function(){return c.a}),n.d(t,"withPrefix",function(){return s.withPrefix}),n.d(t,"navigate",function(){return s.navigate}),n.d(t,"push",function(){return s.push}),n.d(t,"replace",function(){return s.replace}),n.d(t,"navigateTo",function(){return s.navigateTo});var u=n(299),l=n.n(u);n.d(t,"PageRenderer",function(){return l.a});var d=n(43);n.d(t,"parsePath",function(){return d.a});var f=r.a.createContext({}),m=function(e){return r.a.createElement(f.Consumer,null,function(t){return e.data||t[e.query]&&t[e.query].data?(e.render||e.children)(e.data?e.data.data:t[e.query].data):r.a.createElement("div",null,"Loading (StaticQuery)")})};function p(){throw new Error("It appears like Gatsby is misconfigured. Gatsby related `graphql` calls are supposed to only be evaluated at compile time, and then compiled away,. Unfortunately, something went wrong and the query was left in the compiled code.\n\n.Unless your site has a complex or custom babel/Gatsby configuration this is likely a bug in Gatsby.")}m.propTypes={data:i.a.object,query:i.a.string.isRequired,render:i.a.func,children:i.a.func}},299:function(e,t,n){var o;e.exports=(o=n(575))&&o.default||o},318:function(e,t,n){"use strict";n(175);var o=n(0),r=n(323),a=n.n(r),i=n(151),s=n(361),c=["double-bounce","chasing-dots","circle","cube-grid"];var u=Object(i.compose)(Object(i.withProps)(function(e){return{name:e.name||c[Math.floor(Math.random()*c.length)]}}))(function(e){var t=e.name;return Boolean(t)&&o.createElement("div",{className:s.LoadingContainer},o.createElement(a.a,{className:s.Loader,name:t}))}),l=(n(199),n(52),n(30),n(168)),d=n.n(l),f=(n(73),n(46),n(72),n(244),n(45),n(6)),m=n.n(f),p=n(200),g=n(561),h=n.n(g);var b=function(e){var t=e.color,n=void 0===t?"magenta":t,r=e.coords,a=(e.timestamp,d()(e,["color","coords","timestamp"])),i=r.accuracy,s=r.heading,c=r.latitude,u=r.longitude,l=new google.maps.LatLng(c,u);return o.createElement(o.Fragment,null,o.createElement(p.Circle,{center:l,radius:i,options:{fillColor:n,strokeColor:n,fillOpacity:.25,strokeWeight:1}}),o.createElement(p.Marker,Object.assign({icon:{anchor:new google.maps.Point(0,2.6),path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW,strokeColor:n,fillColor:n,fillOpacity:1,rotation:s,scale:10,strokeWeight:1},position:new google.maps.LatLng(c,u)},a)))};n(563),n(565),n(566);var v=function(e){var t=e.fetchedAt,n=e.station;return o.createElement("div",null,o.createElement("ul",null,o.createElement("li",null,"["+n.number.toString().padStart(4,"0")+"] "+n.name+(n.operative?"":" (CLOSED)")),o.createElement("li",null,n.bikes+" bikes / "+n.free+" slots ("+n.total+" total)"),o.createElement("li",null,o.createElement("a",{target:"_blank",href:"https://www.google.com/maps/dir/?api=1&travelmode=bicycling&destination="+n.lat+","+n.lng},n.lat+", "+n.lng)),o.createElement("li",null,"Last Updated: "+t.fromNow())))},w=(n(569),'\n<svg width="100px" height="100px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">\n  <path id="bg" fill="#ffffff" d="m77.438,31.70225c-0.139,-5.802 -1.797,-10.248 -4.202,-14.012c-2.307,-3.607 -5.341,-6.666 -9.258,-8.958c-4.793,-2.803 -11.556,-4.639 -18.766,-3.553c-8.819,1.33 -15.391,6.39 -19.316,12.561c-2.385,3.752 -4.039,8.341 -4.152,14.062c-0.117,5.854 1.706,10.369 3.954,14.261c1.122,1.948 2.132,3.929 3.302,5.805c3.504,5.621 7.291,10.97 10.559,16.765c4.406,7.812 8.044,16.242 10.108,26.371c2.984,-15.367 9.802,-26.583 17.063,-37.58c2.439,-3.692 4.867,-7.382 6.806,-11.41c0.993,-2.063 2.107,-3.996 2.803,-6.306c0.684,-2.283 1.172,-5.035 1.099,-8.006z"/>\n  <path id="fill" fill="currentColor" d="M77.438,31.834c-0.139-5.802-1.797-10.248-4.202-14.012c-2.307-3.607-5.341-6.666-9.258-8.958   c-4.793-2.803-11.556-4.639-18.766-3.553c-8.819,1.33-15.391,6.39-19.316,12.561c-2.385,3.752-4.039,8.341-4.152,14.062   c-0.117,5.854,1.706,10.369,3.954,14.261C26.82,48.143,27.83,50.124,29,52c3.504,5.621,7.291,10.97,10.559,16.765   c4.406,7.812,8.044,16.242,10.108,26.371c2.984-15.367,9.802-26.583,17.063-37.58c2.439-3.692,4.867-7.382,6.806-11.41   c0.993-2.063,2.107-3.996,2.803-6.306C77.023,37.557,77.511,34.805,77.438,31.834z M49.685,52.47   c-11.004,0-19.923-8.92-19.923-19.923c0-11.002,8.919-19.922,19.923-19.922c11.003,0,19.923,8.92,19.923,19.922   C69.607,43.55,60.688,52.47,49.685,52.47z"/>\n</svg>'.trim());function O(e){return{url:function(e){return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(w.replace(/fill="currentColor"/,'fill="'+((t=e.bikes)>10?"forestgreen":t>5?"coral":"crimson")+'"'));var t}(e),labelOrigin:new google.maps.Point(49,33)}}var y=Object(i.compose)(Object(i.withHandlers)({handleOnClick:function(e){var t=e.showInfo,n=e.node;return function(){return t(n)}}}))(function(e){var t=e.handleOnClick,n=(e.showInfo,e.node.station),r=d()(e,["handleOnClick","showInfo","node"]),a=n.lat,i=n.lng;return o.createElement(p.Marker,Object.assign({onClick:t,icon:O(n),label:{text:n.bikes+" | "+n.free,fontSize:"0.75rem",fontWeight:"bold"},position:new google.maps.LatLng(a,i)},r))}),E=Object(i.defaultProps)({mapsApiKey:"AIzaSyBXrYScIU6sWYUWLLlovYhzq-bLzwTgAoc"}),j=n(571),C=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).renderInfo=function(){var e=t.props,n=e.fetchedAt,r=e.selectedNode;if(!r)return!1;var a=r.station,i=a.lat,s=a.lng;return o.createElement(p.InfoWindow,{position:{lat:i,lng:s},onCloseClick:t.props.hideInfo,options:{pixelOffset:new google.maps.Size(0,-100)}},o.createElement(v,{fetchedAt:n,station:r.station}))},t.renderMarker=function(e){if(!e.isValid)return console.debug("Bad Station Found",e.station),!1;var n=t.props.showInfo;return o.createElement(y,{key:e.station.number,node:e,showInfo:n})},t.renderMarkers=function(e){void 0===e&&(e=!0);var n=Array.from(t.props.nodes.values()).map(t.renderMarker);return e?o.createElement(h.a,{averageCenter:!0,enableRetinaIcons:!0,gridSize:60,maxZoom:17},n):n},t.renderPosition=function(){var e=t.props.position;return!!(e&&e.coords&&e.timestamp)&&o.createElement(b,{coords:e.coords,timestamp:e.timestamp})},t}return m()(t,e),t.prototype.render=function(){var e=this.props,t=e.hideInfo,n=e.defaultCenter,r=e.defaultZoom;return o.createElement(p.GoogleMap,{defaultCenter:n,defaultZoom:r,onClick:t},o.createElement(p.BicyclingLayer,null),this.renderMarkers(),this.renderPosition(),this.renderInfo())},t}(o.PureComponent),k=Object(i.compose)(E,Object(i.defaultProps)({defaultCenter:{lat:49.279627,lng:-123.121116},defaultZoom:13}),Object(i.withStateHandlers)({},{showInfo:function(){return function(e){return{selectedNode:e}}},hideInfo:function(){return function(){return{selectedNode:void 0}}}}),Object(i.withProps)(function(e){return{googleMapURL:"https://maps.googleapis.com/maps/api/js?key="+e.mapsApiKey+"&v=3.exp&libraries=geometry,drawing,places",loadingElement:o.createElement("div",{className:j.LoadingContainer},"Loading..."),containerElement:o.createElement("div",{className:j.MapContainer}),mapElement:o.createElement("div",{className:j.Map})}}),Object(i.mapProps)(function(e){e.mapsApiKey;var t=e.nodes,n=d()(e,["mapsApiKey","nodes"]);return Object.assign({nodes:t.reduce(function(e,t){return e.set(t.station.number,t)},new Map)},n)}),p.withScriptjs,p.withGoogleMap)(C),L=n(573),S=n(298),x=n(576);var N=function(e){var t=e.description,n=e.logo,r=e.logoUrl;return o.createElement("div",{className:x.Header},o.createElement("div",{className:x.HeaderLogo},o.createElement("a",{href:r},o.createElement("img",{src:n}))),o.createElement("div",{className:x.HeaderContent},o.createElement("h1",null,t)))},M=n(578);var I="3229557108";var P=Object(i.compose)(Object(i.defaultProps)({errors:[]}),Object(i.fromRenderProps)(function(e){var t=Object.assign({},e);return o.createElement(S.StaticQuery,Object.assign({query:I},t,{data:L}))},function(e){return{site:e.site}}))(function(e){var t=e.errors,n=e.site.siteMetadata,r=n.description,a=n.logo,i=n.logoUrl,s=d()(e,["errors","site"]);return o.createElement("div",{className:M.Container},o.createElement(N,{description:r,logo:a,logoUrl:i}),o.createElement("div",Object.assign({className:M.Content},s)),0!==t.length&&o.createElement("div",null,t))}),A=(n(50),n(89),n(319)),U=n(140),R=n(610),H=n(613),F=n(611),q=n(300),z=n(612),B=n(590),D=n(580),W=n.n(D),T=n(589),_=n(608),G=n(614),Y=n(615),J=n(606),V=n(607),Q=n(609);n(225);n(582),n(583),n(585);var K=n(586),Z=n.n(K),$=function(){function e(e){this.station=void 0,this.station=e}return e.prototype.toString=function(){return this.isValid?"["+this.station.number+"] "+this.station.name+" ("+this.station.bikes+" | "+this.station.free+")":"INVALID"},Z()(e,[{key:"isValid",get:function(){return[Number.isInteger(this.station.bikes),Number.isInteger(this.station.free),Number.isInteger(this.station.total),Number.isInteger(this.station.number),this.station.number>0,Number.isFinite(this.station.lat),0!==this.station.lat,Number.isFinite(this.station.lng),0!==this.station.lng,/^\w/.test(this.station.name),0===this.station.errors.length].every(function(e){return e})}}]),e}();n(587);function X(e){var t=function(e){return void 0===e&&(e={}),Object.assign({data:null,errors:[],bikes:0,free:0,lat:0,lng:0,name:"",number:0,operative:!1,total:0},e)}({data:e,bikes:e.avl_bikes,free:e.free_slots,operative:e.operative,total:e.total_slots});return function(e,t){var n=e.name;try{var o=/^(\d+)\s+(.*)$/.exec(n);if(!o)throw new Error('Unable to parse "number name" from '+n);t.number=Number(o[1]),t.name=o[2]}catch(e){t.errors.push(e)}}(e,t),function(e,t){try{var n=/^\s*(-?\d+\.\d+)\s*,\s*(-?\d+\.\d+)\s*$/.exec(e);if(!n)throw new Error('Unable to parse "lat, lng" from '+e);t.lat=Number(n[1]),t.lng=Number(n[2])}catch(e){t.errors.push(e)}}(e.coordinates,t),t}var ee,te=Object(q.a)(function(e){return e.result.map(X)});!function(e){e[e.Smoove=0]="Smoove"}(ee||(ee={}));var ne=new Map([["test",{location:{lat:49.279627,lng:-123.121116},name:"Test Data",type:"Smoove",uri:"/static_data"}],["vancouver",{location:{lat:49.279627,lng:-123.121116},name:"Mobi Bike Vancouver",type:"Smoove",uri:"http://vancouver-ca.smoove.pro/api-public/stations",cors:!0}]]);var oe=function(){function e(e,t,n){void 0===n&&(n=!1),this.config=void 0,this.verboseOutput=void 0,this.transform=void 0,this.config=e,this.transform=t,this.verboseOutput=n}e.create=function(t,n){var o=n.debug,r="string"==typeof t?function(e){var t=ne.get(e.toLowerCase());if(!t)throw new Error("No station data for source '"+e+"'");return t}(t):t;return new e(r,function(e){var t=e.type;switch(t){case"Smoove":return te;default:throw new Error("Invalid Configuration '"+t+"'")}}(r),o)},e.nearest=function(t,n){return e.create(function(e){return Array.from(ne.values()).map(function(t){return{config:t,distance:google.maps.geometry.spherical.computeDistanceBetween(e,new google.maps.LatLng(t.location.lat,t.location.lng))}}).sort(function(e,t){return e.distance-t.distance})[0].config}(t),n)};var t=e.prototype;return t.getJSON=function(){var e=this.config.cors?"https://cors.io/?"+this.config.uri:this.config.uri;this.debug("Fetching stations from '"+e+"' ...");var t=this.config.options?this.config.options.headers:void 0;return Y.a.getJSON(e,t)},t.getStations=function(e){var t=this;return(e||this.getJSON()).pipe(Object(J.a)(function(e){t.debug("Fetch Response",e)}),this.transform,Object(q.a)(function(e){return t.debug("Fetched "+e.length+" stations"),{config:t.config,nodes:e.map(function(e){return new $(e)}),fetchedAt:W()()}}),Object(V.a)(function(e){return void 0===e&&(e={}),t.debug("Fetch failed: "+(e.message||"Unknown Error"),e),Object(T.a)({error:e,config:t.config,fetchedAt:W()(),nodes:[]})}))},t.watchStations=function(e,t,n){var o=this;return void 0===e&&(e=Object(T.a)(!0)),void 0===t&&(t=300),Object(_.a)(Object(G.a)(0,1e3*t),e).pipe(Object(Q.a)(100),Object(B.a)(function(){return o.getStations(n)}))},t.debug=function(e){if(this.verboseOutput){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];n.length?console.log(e,n):console.log(e)}},e}(),re=n(592);Object(i.setObservableConfig)({fromESObservable:A.a});Object(i.withProps)(function(){return{params:function(){if("undefined"==typeof window)return null;var e=new Map;return new URLSearchParams(window.location.search).forEach(function(t,n){e.set(n.toLowerCase(),t)}),e}()}});var ae=Object(i.compose)(function(e){void 0===e&&(e={enableHighAccuracy:!0});var t=new U.a(function(t){navigator.geolocation.watchPosition(function(e){t.next(e)},function(e){t.error({error:e})},e)});return Object(i.mapPropsStream)(function(e){return Object(R.a)(t.pipe(Object(H.a)(void 0)),e,function(e,t){return console.log("[position]",e,t),Object.assign({},t,{position:e})})})}(),function(e){void 0===e&&(e="vancouver");var t=new re.Subject;return Object(i.mapPropsStream)(function(n){var o=n.pipe(Object(F.a)(function(e){var t=e.params;return Boolean(t)}),Object(q.a)(function(t){var n=t.params;return{debug:Boolean(n.get("debug")),source:n.get("source")||(n.get("test")?"test":e)}}),Object(z.a)(function(e,t){return e.debug===t.debug&&e.source===t.source}),Object(B.a)(function(e){var n=e.debug,o=e.source;return console.log("fetch",{source:o,debug:n}),oe.create(o,{debug:n}).watchStations(t)}));return Object(R.a)(o,n,function(e,n){return console.log("[stations]",e,n),Object.assign({},n,{stations:e,reload:function(){console.log("reload"),t.next()}})})})}())(function(e){var t=e.position,n=e.reload,r=e.stations;return console.log("reload",n),o.createElement(P,null,r?o.createElement(k,{fetchedAt:r.fetchedAt,location:r.config.location,nodes:r.nodes,position:t}):o.createElement(u,null))});var ie=function(){return o.createElement("div",null,o.createElement("h1",null,"NOT FOUND"),o.createElement("p",null,"You just hit a route that doesn't exist... the sadness."))};n.d(t,"b",function(){return u}),n.d(t,"d",function(){return k}),n.d(t,"a",function(){return ae}),n.d(t,"c",function(){return ie})},361:function(e,t,n){e.exports={LoadingContainer:"Loader-module--LoadingContainer--1fcG7",Loader:"Loader-module--Loader--3Q9b5"}},571:function(e,t,n){e.exports={LoadingContainer:"StationMap-module--LoadingContainer--3ziae",MapContainer:"StationMap-module--MapContainer--3ypYa",Map:"StationMap-module--Map--foP4U"}},573:function(e){e.exports={data:{site:{siteMetadata:{description:"Find mobi bikes in Vancouver, BC.",logo:"https://www.mobibikes.ca/sites/all/themes/smoove_bootstrap/logo.png",logoUrl:"https://www.mobibikes.ca/en#the-map"}}}}},575:function(e,t,n){"use strict";n.r(t);n(30);var o=n(0),r=n.n(o),a=n(3),i=n.n(a),s=n(68),c=n(141),u=function(e){var t=e.location,n=c.default.getResourcesForPathnameSync(t.pathname);return r.a.createElement(s.a,Object.assign({location:t,pageResources:n},n.json))};u.propTypes={location:i.a.shape({pathname:i.a.string.isRequired}).isRequired},t.default=u},576:function(e,t,n){e.exports={Header:"Header-module--Header--umzWI",HeaderLogo:"Header-module--HeaderLogo--2YUir",HeaderContent:"Header-module--HeaderContent--1J1nM"}},578:function(e,t,n){e.exports={Container:"DefaultLayout-module--Container--1-A96",Content:"DefaultLayout-module--Content--2xYut"}}}]);
//# sourceMappingURL=1-258a74e898393a52554c.js.map