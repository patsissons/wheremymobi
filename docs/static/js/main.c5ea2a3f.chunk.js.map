{"version":3,"sources":["App/components/Header/Header.module.scss","components/Loader/Loader.module.scss","App/App.module.scss","config/env.ts","App/components/StationMap/components/CustomButton/CustomButton.module.scss","App/components/StationMap/StationMap.module.scss","components/Loader/Loader.tsx","App/components/Header/Header.tsx","utilities/google.ts","App/components/StationMap/components/CustomButton/CustomButton.tsx","App/components/StationMap/components/CustomControl/CustomControl.ts","App/components/StationMap/components/GpsMarker/GpsMarker.tsx","App/components/StationMap/components/StationInfo/StationInfo.tsx","App/components/StationMap/hooks/useMarkerClusterer.tsx","App/components/StationMap/images/bike.svg","App/components/StationMap/images/circle-minus.svg","App/components/StationMap/images/circle-plus.svg","App/components/StationMap/images/gps.svg","App/components/StationMap/images/refresh.svg","App/components/StationMap/images/slot.svg","App/components/StationMap/StationMap.tsx","App/hooks/usePosition.ts","data/config.ts","data/transform/Smoove.ts","models/Station.ts","data/StationSource.ts","App/hooks/useStations.ts","serviceWorker.ts","index.tsx","App/App.tsx","App/hooks/useQueryParams.ts"],"names":["module","exports","Header","HeaderLogo","HeaderContent","LoadingContainer","Loader","Container","Content","process","dotenv__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","n","dotenv","config","env","CustomButton","MapContainer","ButtonImage","loaders","_ref","_ref$name","name","Math","floor","random","length","react_default","a","createElement","className","styles","dist_default","href","alt","src","metadata","description","mockGoogle","maps","googleMapsAsync","allowMock","arguments","undefined","window","google","Error","useGoogleNamespace","props","Object","objectWithoutProperties","assign","classNames","type","CustomControl","_ref$bindingPosition","bindingPosition","children","_ref$onMounted","onMounted","onContainerMounted","state","useContext","GoogleMapContext","_useState","useState","_useState2","slicedToArray","mounted","setMounted","_useState3","document","container","_useGoogleNamespace","useLayoutEffect","map","controls","ControlPosition","push","ReactDOM","createPortal","style","margin","GpsMarker","_ref$color","color","coords","timestamp","radius","accuracy","heading","position","lat","latitude","lng","longitude","Fragment","index_esm","opts","center","fillColor","strokeColor","fillOpacity","strokeWeight","icon","anchor","Point","path","SymbolPath","FORWARD_CLOSED_ARROW","rotation","scale","zIndex","Marker","MAX_ZINDEX","StationInfo","fetchedAt","station","concat","number","toString","padStart","operative","bikes","free","total","rel","target","fromNow","defaultOpts","averageCenter","gridSize","maxZoom","enableRetinaIcons","_extends","i","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","bike_ref2","d","bike_SvgBike","svgRef","viewBox","ref","ForwardRef","forwardRef","p","circle_minus_extends","circle_minus_objectWithoutProperties","circle_minus_objectWithoutPropertiesLoose","circle_minus_ref2","fill","circle_minus_SvgCircleMinus","circle_minus_ForwardRef","circle_plus_extends","circle_plus_objectWithoutProperties","circle_plus_objectWithoutPropertiesLoose","circle_plus_ref2","_ref3","circle_plus_SvgCirclePlus","circle_plus_ForwardRef","gps_extends","gps_objectWithoutProperties","gps_objectWithoutPropertiesLoose","gps_ref2","gps_SvgGps","gps_ForwardRef","refresh_extends","refresh_objectWithoutProperties","refresh_objectWithoutPropertiesLoose","refresh_ref2","refresh_SvgRefresh","refresh_ForwardRef","slot_extends","slot_objectWithoutProperties","slot_objectWithoutPropertiesLoose","slot_ref2","slot_SvgSlot","slot_ForwardRef","defaultZoom","StationMap","location","stations","updateStations","_useContext$state","_useContext$state$map","followGps","setFollowGps","_useState4","centered","setCentered","_useState5","_useState6","validStations","setValidStations","_useState7","_useState8","selectedStation","setSelectedStation","_useState9","_useState10","preferBikes","setPreferBikes","_useState11","_useState12","showStations","setShowStations","MarkerClusterer","_useContext","dispatch","clusterer","setClusterer","context","setContext","Provider","useCallback","value","useEffect","MarkerClustererPlus","objectSpread","action","id","object","objects","addMarker","marker","get","removeMarker","useMarkerClusterer","centerGps","isValidPosition","latLngFromPosition","zoom","max","min","log2","gpsZoom","setCenter","setZoom","updatedStations","forEach","valid","console","debug","prev","next","prevSorted","sort","_ref4","_ref5","_ref4$number","aId","_ref5$number","bId","nextSorted","_ref6","_ref7","_ref6$number","_ref7$number","every","JSON","stringify","data","stationComparer","stationCollectionComparer","apiKey","onClick","onDragStart","LoadingComponent","disabled","focusable","aria-hidden","preferNearestBike","distance","geometry","spherical","computeDistanceBetween","LatLng","filter","_ref3$station","errors","left","right","nearestStation","getCenter","panTo","_ref2","shift","colorForCount","strokeOpacity","label","text","fontSize","fontWeight","anchorId","onCloseClick","visible","_ref8","_ref8$coords","Boolean","colors","low","mid","high","count","defaultOptions","enableHighAccuracy","StationSourceType","create","smooveData","_parseNameAndNumber","match","exec","Number","error","nameNumberError","parseNameAndNumber","_parseLatLng","coordinates","latLngError","parseLatLng","avl_bikes","free_slots","total_slots","isInteger","isFinite","test","x","createStation","Smoove","result","configMap","Map","uri","cors","StationSource","transform","verboseOutput","classCallCheck","createClass","configOrKey","getConfig","mapTransform","options","Array","from","values","getConfigByLocation","_getJSON","asyncToGenerator","regenerator_default","mark","_callee","response","json","wrap","_context","fetch","headers","sent","abrupt","stop","_getStations","_callee2","_context2","getJSON","moment","t0","message","_len","args","_key","log","defaultSourceName","useStations","_getSourceName","params","sourceName","getSourceName","stationSourceResult","setStationSourceResult","useMemo","getStations","then","useDebugValue","hostname","render","setParams","URLSearchParams","search","set","toLowerCase","useQueryParams","watchId","setWatchId","setPosition","setError","updatePosition","navigator","geolocation","getCurrentPosition","watchPosition","clearWatch","usePosition","_useStations","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.c5ea2a3f.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"Header\":\"Header_Header__1XO4R\",\"HeaderLogo\":\"Header_HeaderLogo__1dLj0\",\"HeaderContent\":\"Header_HeaderContent__3wHIB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"LoadingContainer\":\"Loader_LoadingContainer__1zHC6\",\"Loader\":\"Loader_Loader__3w7V8\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Container\":\"App_Container__Sk-T4\",\"Content\":\"App_Content__2YSLD\"};","import dotenv from 'dotenv';\n\ndotenv.config();\nconst {env = {}} = typeof process === 'undefined' ? {} : process;\n\nexport {env};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"CustomButton\":\"CustomButton_CustomButton__2nL-I\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"MapContainer\":\"StationMap_MapContainer__2mxHY\",\"ButtonImage\":\"StationMap_ButtonImage__1ypMu\"};","import React from 'react';\nimport Spinner, {SpinnerProps} from 'react-spinkit';\n\nimport styles from './Loader.module.scss';\n\ntype SpinnerName = 'double-bounce' | 'chasing-dots' | 'circle' | 'cube-grid';\nexport const loaders: Required<SpinnerProps['name']>[] = [\n  'double-bounce',\n  'chasing-dots',\n  'circle',\n  'cube-grid',\n];\n\nexport function randomLoaderName() {\n  return loaders[Math.floor(Math.random() * loaders.length)] as SpinnerName;\n}\n\nexport interface Props {\n  name?: SpinnerName;\n}\n\nexport function Loader({name = randomLoaderName()}: Props) {\n  if (name) {\n    return (\n      <div className={styles.LoadingContainer}>\n        <Spinner className={styles.Loader} name={name} />\n      </div>\n    );\n  }\n\n  return null;\n}\n","import React from 'react';\nimport {metadata} from 'config';\n\nimport styles from './Header.module.scss';\n\nexport function Header() {\n  return (\n    <div className={styles.Header}>\n      <div className={styles.HeaderLogo}>\n        <a href=\"https://www.mobibikes.ca/en#the-map\">\n          <img\n            alt=\"logo\"\n            src=\"https://www.mobibikes.ca/sites/all/themes/smoove_bootstrap/logo.png\"\n          />\n        </a>\n      </div>\n      <div className={styles.HeaderContent}>\n        <h1>{metadata.description}</h1>\n      </div>\n    </div>\n  );\n}\n","/* global google */\n\ndeclare global {\n  interface Window {\n    google: typeof google;\n  }\n}\n\nconst mockGoogle: any = {\n  maps: {},\n};\n\nexport type google = typeof google;\n\nexport function googleMapsAsync(allowMock = true): typeof google {\n  if (window.google) {\n    return window.google;\n  }\n\n  if (allowMock) {\n    return mockGoogle;\n  }\n\n  throw new Error('google.maps API has not yet loaded');\n}\n\nexport function useGoogleNamespace(): [typeof google, () => typeof google] {\n  return [googleMapsAsync(), googleMapsAsync];\n}\n","import React, {ButtonHTMLAttributes} from 'react';\nimport classNames from 'classnames';\n\nimport styles from './CustomButton.module.scss';\n\nexport function CustomButton({\n  className,\n  ...props\n}: ButtonHTMLAttributes<HTMLButtonElement>) {\n  return (\n    <button\n      className={classNames(styles.CustomButton, className)}\n      type=\"button\"\n      {...props}\n    />\n  );\n}\n","import {ReactNode, useContext, useLayoutEffect, useState} from 'react';\nimport ReactDOM from 'react-dom';\nimport {GoogleMapContext} from '@googlemap-react/core';\nimport {google, useGoogleNamespace} from 'utilities/google';\n\ninterface Props {\n  bindingPosition: keyof typeof google.maps.ControlPosition;\n  children?: ReactNode;\n  onMounted?(container: HTMLDivElement): void;\n}\n\nexport function CustomControl({\n  bindingPosition = 'RIGHT_TOP',\n  children,\n  onMounted = onContainerMounted,\n}: Props) {\n  const {state} = useContext(GoogleMapContext);\n  const [mounted, setMounted] = useState(false);\n  const [container] = useState(document.createElement('div'));\n  const [google] = useGoogleNamespace();\n  useLayoutEffect(() => {\n    if (state && state.map && !mounted) {\n      state.map.controls[google.maps.ControlPosition[bindingPosition]].push(\n        container,\n      );\n\n      onMounted(container);\n\n      setMounted(true);\n    }\n  }, [\n    bindingPosition,\n    container,\n    google.maps.ControlPosition,\n    mounted,\n    onMounted,\n    state,\n    state.map,\n  ]);\n\n  return typeof document === 'undefined'\n    ? null\n    : ReactDOM.createPortal(children, container);\n}\n\nexport function onContainerMounted(container: HTMLDivElement) {\n  container.style.margin = '10px 10px 23px';\n}\n","import React from 'react';\nimport {Circle, Marker} from '@googlemap-react/core';\nimport {useGoogleNamespace} from 'utilities/google';\n\ninterface Props {\n  color?: string;\n  coords: Coordinates;\n  timestamp: number;\n}\n\nexport function GpsMarker({color = 'magenta', coords, timestamp}: Props) {\n  const [google] = useGoogleNamespace();\n  const {accuracy: radius, heading, latitude, longitude} = coords;\n\n  const position: google.maps.LatLngLiteral = {\n    lat: latitude,\n    lng: longitude,\n  };\n\n  return (\n    <>\n      <Circle\n        opts={{\n          center: position,\n          radius,\n          fillColor: color,\n          strokeColor: color,\n          fillOpacity: 0.25,\n          strokeWeight: 1,\n        }}\n      />\n      <Marker\n        opts={{\n          icon: {\n            anchor: new google.maps.Point(0, 2.6),\n            path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW,\n            strokeColor: color,\n            fillColor: color,\n            fillOpacity: 1,\n            rotation: heading || 0,\n            scale: 10,\n            strokeWeight: 1,\n          },\n          position,\n          zIndex: google.maps.Marker.MAX_ZINDEX,\n        }}\n      />\n    </>\n  );\n}\n","import React from 'react';\nimport moment from 'moment';\nimport {ValidStation} from 'models';\n\ninterface Props {\n  fetchedAt: moment.Moment;\n  station: ValidStation;\n}\n\nexport function StationInfo({fetchedAt, station}: Props) {\n  return (\n    <ul>\n      <li>{`[${station.number.toString().padStart(4, '0')}] ${station.name}${\n        station.operative ? '' : ' (CLOSED)'\n      }`}</li>\n      <li>{`${station.bikes} bikes / ${station.free} slots (${\n        station.total\n      } total)`}</li>\n      <li>\n        <a\n          rel=\"noopener noreferrer\"\n          target=\"_blank\"\n          href={`https://www.google.com/maps/dir/?api=${1}&travelmode=bicycling&destination=${\n            station.lat\n          },${station.lng}`}\n        >{`${station.lat}, ${station.lng}`}</a>\n      </li>\n      <li>{`Last Updated: ${fetchedAt.fromNow()}`}</li>\n    </ul>\n  );\n}\n","import React, {useCallback, useContext, useState, useEffect} from 'react';\nimport MarkerClustererPlus, {Options} from '@google/markerclustererplus';\nimport {GoogleMapContext} from '@googlemap-react/core';\nimport {Props} from '@shopify/useful-types';\nimport {useGoogleNamespace} from 'utilities/google';\n\ntype Context = Props<typeof GoogleMapContext.Provider>['value'];\ntype Action = Context['dispatch'] extends (action: infer T) => void ? T : never;\n\nconst defaultOpts: Options = {\n  averageCenter: true,\n  gridSize: 90,\n  maxZoom: 17,\n  enableRetinaIcons: false,\n};\n\nexport function useMarkerClusterer(opts: Options = {}) {\n  const {dispatch, state} = useContext(GoogleMapContext);\n  const [clusterer, setClusterer] = useState<MarkerClustererPlus>();\n  const [context, setContext] = useState<Context>();\n  const Provider = useCallback(\n    (props: {children?: any}) =>\n      context ? <GoogleMapContext.Provider value={context} {...props} /> : null,\n    [context],\n  );\n  const [google] = useGoogleNamespace();\n  useEffect(() => {\n    if (!clusterer && state && state.map) {\n      setClusterer(\n        new MarkerClustererPlus(state.map, [], {\n          ...defaultOpts,\n          ...opts,\n        }),\n      );\n    }\n    if (!context && clusterer && state) {\n      setContext({\n        dispatch(action: Action) {\n          const {type, id, object} = action;\n\n          if (clusterer && state && state.objects) {\n            switch (type) {\n              case 'add_object':\n                if (object && object instanceof google.maps.Marker) {\n                  clusterer.addMarker(object);\n                }\n                break;\n              case 'remove_object':\n                if (id) {\n                  const marker = state.objects.get(id);\n\n                  if (marker && marker instanceof google.maps.Marker) {\n                    clusterer.removeMarker(marker);\n                  }\n                }\n                break;\n            }\n          }\n\n          // console.log('*** ACTION:', action);\n          dispatch(action);\n        },\n        state,\n      });\n    }\n  }, [clusterer, context, dispatch, google.maps.Marker, opts, state]);\n\n  return Provider;\n}\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M408,132.6c25.5,0,45.9-20.4,45.9-45.9S433.5,40.8,408,40.8s-45.9,20.4-45.9,45.9S382.5,132.6,408,132.6z M484.5,316.2 c-71.4,0-127.5,56.1-127.5,127.5s56.1,127.5,127.5,127.5S612,515.101,612,443.7S555.9,316.2,484.5,316.2z M484.5,532.95 c-48.45,0-89.25-40.801-89.25-89.25c0-48.451,40.8-89.25,89.25-89.25s89.25,40.799,89.25,89.25 C573.75,492.149,532.95,532.95,484.5,532.95z M377.4,265.2h107.1v-45.9h-81.6l-48.45-84.15c-7.65-12.75-20.4-20.4-38.25-20.4 c-12.75,0-22.95,5.1-30.6,12.75l-94.35,94.35c-7.65,7.65-12.75,17.85-12.75,30.6c0,15.3,7.65,30.6,20.4,38.25l86.7,51v127.5h45.9 V303.45l-56.1-43.35l58.65-58.65L377.4,265.2z M127.5,316.2C56.1,316.2,0,372.3,0,443.7s56.1,127.5,127.5,127.5 S255,515.101,255,443.7S198.9,316.2,127.5,316.2z M127.5,532.95c-48.45,0-89.25-40.801-89.25-89.25 c0-48.451,40.8-89.25,89.25-89.25s89.25,40.799,89.25,89.25C216.75,492.149,175.95,532.95,127.5,532.95z\"\n});\n\nvar SvgBike = function SvgBike(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 612 612\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgBike, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/bike.44bc6267.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  fill: \"#637381\",\n  d: \"M10 0C4.486 0 0 4.486 0 10s4.486 10 10 10 10-4.486 10-10S15.514 0 10 0m0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8m4-9H6a1 1 0 1 0 0 2h8a1 1 0 1 0 0-2\"\n});\n\nvar SvgCircleMinus = function SvgCircleMinus(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 20 20\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgCircleMinus, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/circle-minus.e8cc111e.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M10 0C4.486 0 0 4.486 0 10s4.486 10 10 10 10-4.486 10-10S15.514 0 10 0zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z\",\n  fill: \"#637381\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M8.996 8.996V7.008c.001-.043 0-.054.004-.097.044-.449.423-.845.879-.9.094-.011.115-.007.145-.007.043.002.054.002.097.007.448.054.834.442.879.9.004.043.003.054.004.097v1.988h1.992c.016 0 .032 0 .048.001.49.035.918.441.954.93.039.545-.424 1.063-1.002 1.077h-1.992V13c-.01.411-.272.797-.648.939-.584.221-1.327-.217-1.359-.891-.001-.016-.001-.032-.001-.048v-1.996H7.004c-.511-.012-.966-.435-1.002-.931-.038-.53.396-1.049.954-1.076.016-.001.032-.001.048-.001h1.992z\",\n  fill: \"#637381\"\n});\n\nvar SvgCirclePlus = function SvgCirclePlus(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 20 20\",\n    ref: svgRef\n  }, props), _ref2, _ref3);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgCirclePlus, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/circle-plus.2ab94f29.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M280.5,178.5c-56.1,0-102,45.9-102,102c0,56.1,45.9,102,102,102c56.1,0,102-45.9,102-102     C382.5,224.4,336.6,178.5,280.5,178.5z M507.45,255C494.7,147.9,410.55,63.75,306,53.55V0h-51v53.55     C147.9,63.75,63.75,147.9,53.55,255H0v51h53.55C66.3,413.1,150.45,497.25,255,507.45V561h51v-53.55     C413.1,494.7,497.25,410.55,507.45,306H561v-51H507.45z M280.5,459C181.05,459,102,379.95,102,280.5S181.05,102,280.5,102     S459,181.05,459,280.5S379.95,459,280.5,459z\"\n});\n\nvar SvgGps = function SvgGps(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 561 561\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgGps, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/gps.9f3589a2.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M55.89,262.818c-3-26-0.5-51.1,6.3-74.3c22.6-77.1,93.5-133.8,177.6-134.8v-50.4c0-2.8,3.5-4.3,5.8-2.6l103.7,76.2         c1.7,1.3,1.7,3.9,0,5.1l-103.6,76.2c-2.4,1.7-5.8,0.2-5.8-2.6v-50.3c-55.3,0.9-102.5,35-122.8,83.2c-7.7,18.2-11.6,38.3-10.5,59.4         c1.5,29,12.4,55.7,29.6,77.3c9.2,11.5,7,28.3-4.9,37c-11.3,8.3-27.1,6-35.8-5C74.19,330.618,59.99,298.218,55.89,262.818z         M355.29,166.018c17.3,21.5,28.2,48.3,29.6,77.3c1.1,21.2-2.9,41.3-10.5,59.4c-20.3,48.2-67.5,82.4-122.8,83.2v-50.3         c0-2.8-3.5-4.3-5.8-2.6l-103.7,76.2c-1.7,1.3-1.7,3.9,0,5.1l103.6,76.2c2.4,1.7,5.8,0.2,5.8-2.6v-50.4         c84.1-0.9,155.1-57.6,177.6-134.8c6.8-23.2,9.2-48.3,6.3-74.3c-4-35.4-18.2-67.8-39.5-94.4c-8.8-11-24.5-13.3-35.8-5         C348.29,137.718,346.09,154.518,355.29,166.018z\"\n});\n\nvar SvgRefresh = function SvgRefresh(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 491.236 491.236\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgRefresh, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/refresh.137b889f.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"g\", null, React.createElement(\"path\", {\n  d: \"M408,0H51C22.95,0,0,22.95,0,51v357c0,28.05,22.95,51,51,51h357c28.05,0,51-22.95,51-51V51C459,22.95,436.05,0,408,0z  M173.4,265.2V357h-45.9V102h109.65c38.25,0,56.1,7.65,71.399,22.95c17.851,15.3,22.95,35.7,22.95,58.65 c0,25.5-7.65,45.9-22.95,58.65s-33.149,20.4-71.399,20.4H173.4V265.2z\"\n}), React.createElement(\"path\", {\n  d: \"M173.4,229.5v-91.8h58.65c17.851,0,30.601,5.1,38.25,15.3c7.65,10.2,12.75,17.85,12.75,30.6c0,15.3-5.1,22.95-12.75,33.15 c-7.649,7.65-17.85,12.75-35.7,12.75H173.4z\"\n}));\n\nvar SvgSlot = function SvgSlot(_ref) {\n  var svgRef = _ref.svgRef,\n      props = _objectWithoutProperties(_ref, [\"svgRef\"]);\n\n  return React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 459 459\",\n    ref: svgRef\n  }, props), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgSlot, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/slot.ae84d45d.svg\";\nexport { ForwardRef as ReactComponent };","import React, {useContext, useEffect, useState, useCallback} from 'react';\nimport {\n  BicyclingLayer,\n  GoogleMapContext,\n  InfoWindow,\n  MapBox,\n  Marker,\n} from '@googlemap-react/core';\nimport moment from 'moment';\nimport {Loader} from 'components';\nimport {Station, ValidStation} from 'models';\nimport {googleMapsAsync} from 'utilities/google';\nimport {\n  CustomButton,\n  CustomControl,\n  GpsMarker,\n  StationInfo,\n} from './components';\nimport {useMarkerClusterer} from './hooks';\nimport {\n  BikeImage,\n  CircleMinus,\n  CirclePlus,\n  GpsImage,\n  RefreshImage,\n  SlotImage,\n} from './images';\n\nimport styles from './StationMap.module.scss';\n\nconst defaultZoom = 13;\nconst maxZoom = 17;\n\nexport interface Props {\n  fetchedAt: moment.Moment;\n  location: google.maps.LatLngLiteral;\n  stations: Station[];\n  position: Position | undefined;\n  updateStations(): void;\n}\n\nexport function StationMap({\n  fetchedAt,\n  location,\n  stations,\n  updateStations,\n  position,\n}: Props) {\n  const {state: {map = undefined} = {}} = useContext(GoogleMapContext);\n  const [followGps, setFollowGps] = useState(true);\n  const [centered, setCentered] = useState(false);\n  const [validStations, setValidStations] = useState<ValidStation[]>([]);\n  const [selectedStation, setSelectedStation] = useState<ValidStation>();\n  const [preferBikes, setPreferBikes] = useState(true);\n  const [showStations, setShowStations] = useState(true);\n  // const [dragging, setDragging] = useState(false);\n  const MarkerClusterer = useMarkerClusterer();\n  const centerGps = useCallback(() => {\n    if (map) {\n      const center = isValidPosition(position) && latLngFromPosition(position);\n      const zoom = gpsZoom(position);\n\n      if (center) {\n        map.setCenter(center);\n      }\n\n      if (zoom) {\n        map.setZoom(zoom);\n      }\n\n      if (!centered) {\n        setCentered(true);\n      }\n    }\n  }, [centered, map, position]);\n  useEffect(() => {\n    const updatedStations: ValidStation[] = [];\n\n    stations.forEach((station) => {\n      if (!station.valid) {\n        // this should never happen\n        // eslint-disable-next-line no-console\n        console.debug(`Bad Station Found`, station);\n      }\n\n      updatedStations.push(station as ValidStation);\n    });\n\n    if (!stationCollectionComparer(validStations, updatedStations)) {\n      setValidStations(updatedStations);\n    }\n  }, [stations, validStations]);\n  useEffect(() => {\n    if (followGps) {\n      centerGps();\n    }\n  }, [followGps, centerGps]);\n\n  function selectedNearestStation() {\n    if (map) {\n      const station = nearestStation(\n        (followGps &&\n          isValidPosition(position) &&\n          latLngFromPosition(position)) ||\n          map.getCenter(),\n        validStations,\n        preferBikes,\n      );\n\n      if (station === selectedStation) {\n        map.panTo(station);\n        map.setZoom(maxZoom);\n      } else {\n        if (followGps) {\n          setFollowGps(false);\n        }\n        setSelectedStation(station);\n      }\n    }\n  }\n\n  function handleDragStart() {\n    if (followGps) {\n      setFollowGps(false);\n    }\n\n    if (centered) {\n      setCentered(false);\n    }\n\n    // setDragging(true);\n  }\n\n  function handleGpsCenter() {\n    if (followGps) {\n      if (centered) {\n        if (followGps) {\n          setFollowGps(false);\n        }\n\n        if (centered) {\n          setCentered(false);\n        }\n      } else {\n        centerGps();\n      }\n    } else if (!followGps) {\n      setFollowGps(true);\n    }\n  }\n\n  return (\n    <div className={styles.MapContainer}>\n      <MapBox\n        apiKey=\"AIzaSyBXrYScIU6sWYUWLLlovYhzq-bLzwTgAoc\"\n        opts={{\n          center: location,\n          zoom: defaultZoom,\n          maxZoom,\n        }}\n        onClick={() => setSelectedStation(undefined)}\n        // onDragEnd={() => setDragging(false)}\n        onDragStart={handleDragStart}\n        LoadingComponent={<Loader />}\n      />\n      <BicyclingLayer />\n      <CustomControl bindingPosition=\"BOTTOM_CENTER\">\n        <CustomButton onClick={updateStations}>\n          <RefreshImage className={styles.ButtonImage} />\n        </CustomButton>\n      </CustomControl>\n      <CustomControl bindingPosition=\"BOTTOM_CENTER\">\n        <CustomButton\n          disabled={!isValidPosition(position)}\n          onClick={handleGpsCenter}\n        >\n          <GpsImage\n            className={styles.ButtonImage}\n            style={{\n              fill: followGps ? '#008ABF' : '#000',\n              fillOpacity: isValidPosition(position) ? 1 : 0.25,\n            }}\n            focusable=\"false\"\n            aria-hidden=\"true\"\n          />\n        </CustomButton>\n      </CustomControl>\n      <CustomControl bindingPosition=\"BOTTOM_CENTER\">\n        <CustomButton onClick={selectedNearestStation}>\n          {preferBikes ? (\n            <BikeImage className={styles.ButtonImage} />\n          ) : (\n            <SlotImage\n              className={styles.ButtonImage}\n              style={{fill: '#008ABF'}}\n            />\n          )}\n        </CustomButton>\n      </CustomControl>\n      <CustomControl bindingPosition=\"RIGHT_TOP\">\n        <CustomButton onClick={() => setPreferBikes((value) => !value)}>\n          {preferBikes ? (\n            <BikeImage className={styles.ButtonImage} />\n          ) : (\n            <SlotImage\n              className={styles.ButtonImage}\n              style={{fill: '#008ABF'}}\n            />\n          )}\n        </CustomButton>\n      </CustomControl>\n      <CustomControl bindingPosition=\"RIGHT_TOP\">\n        <CustomButton onClick={() => setShowStations((value) => !value)}>\n          {showStations ? (\n            <CircleMinus className={styles.ButtonImage} />\n          ) : (\n            <CirclePlus className={styles.ButtonImage} />\n          )}\n        </CustomButton>\n      </CustomControl>\n      {showStations && map && validStations.length > 0 && (\n        <MarkerClusterer>\n          {validStations.map(({bikes, free, lat, lng, number, total}) => {\n            return (\n              <Marker\n                key={number}\n                id={`station-${number}`}\n                onClick={(id) =>\n                  setSelectedStation(\n                    validStations\n                      .filter((station) => station.number === number)\n                      .shift(),\n                  )\n                }\n                opts={{\n                  icon: {\n                    path: 'M-20,0a20,20 0 1,0 40,0a20,20 0 1,0 -40,0',\n                    fillColor: colorForCount(preferBikes ? bikes : free, total),\n                    fillOpacity: 1,\n                    strokeColor: 'white',\n                    strokeOpacity: 1,\n                  },\n                  label: {\n                    color: 'white',\n                    text: `${bikes} | ${free}`,\n                    fontSize: '0.75rem',\n                    fontWeight: 'bold',\n                  },\n                  position: {lat, lng},\n                  // visible: !dragging,\n                }}\n              />\n            );\n          })}\n        </MarkerClusterer>\n      )}\n      {map && position && position.coords && position.timestamp && (\n        <GpsMarker coords={position.coords} timestamp={position.timestamp} />\n      )}\n      {map && selectedStation && (\n        <InfoWindow\n          anchorId={`station-${selectedStation.number}`}\n          onCloseClick={() => setSelectedStation(undefined)}\n          visible\n        >\n          <StationInfo fetchedAt={fetchedAt} station={selectedStation} />\n        </InfoWindow>\n      )}\n    </div>\n  );\n}\n\nexport function nearestStation(\n  source: google.maps.LatLng,\n  stations: ValidStation[],\n  preferNearestBike: boolean | undefined,\n) {\n  const google = googleMapsAsync();\n\n  return stations\n    .map((station) => ({\n      station,\n      distance: google.maps.geometry.spherical.computeDistanceBetween(\n        source,\n        new google.maps.LatLng(station.lat, station.lng),\n      ),\n    }))\n    .filter(\n      ({station: {bikes, errors, free, operative}}) =>\n        preferNearestBike == null ||\n        ((!errors || !errors.length) &&\n          operative &&\n          (preferNearestBike ? bikes > 0 : free > 0)),\n    )\n    .sort((left, right) => left.distance - right.distance)[0].station;\n}\n\nfunction stationCollectionComparer(prev: Station[], next: Station[]) {\n  if (prev.length !== next.length) {\n    return false;\n  }\n\n  const prevSorted = prev.sort(\n    ({number: aId = 0}, {number: bId = 0}) => aId - bId,\n  );\n  const nextSorted = next.sort(\n    ({number: aId = 0}, {number: bId = 0}) => aId - bId,\n  );\n\n  return prevSorted.every((prev, i) => stationComparer(prev, nextSorted[i]));\n}\n\nfunction stationComparer(prev: Station, next: Station) {\n  return (\n    prev.number === next.number &&\n    prev.valid === next.valid &&\n    JSON.stringify(prev.data) === JSON.stringify(next.data)\n  );\n}\n\nfunction latLngFromPosition({coords: {latitude, longitude}}: Position) {\n  const google = googleMapsAsync();\n\n  return new google.maps.LatLng(latitude, longitude);\n}\n\nfunction gpsZoom(position: Position | undefined, max = maxZoom) {\n  if (position) {\n    const {\n      coords: {accuracy},\n    } = position;\n\n    // magic number explained here: https://gis.stackexchange.com/a/111589\n    return Math.min(max, Math.max(1, Math.log2(591657550 / accuracy) - 6));\n  }\n\n  return undefined;\n}\n\nfunction isValidPosition(position: Position | undefined): position is Position {\n  return Boolean(\n    position &&\n      position.coords.latitude !== 0 &&\n      position.coords.longitude !== 0,\n  );\n}\n\nconst colors = {\n  low: 'salmon',\n  mid: 'sandybrown',\n  high: 'mediumseagreen',\n};\n\nfunction colorForCount(count: number, total: number) {\n  const fraction = count / total;\n  if (fraction >= 0.5) {\n    return colors.high;\n  }\n\n  return count >= 0.25 ? colors.mid : colors.low;\n}\n","import {useCallback, useDebugValue, useEffect, useState} from 'react';\nimport moment from 'moment';\nimport {QueryParams} from './useQueryParams';\n\ninterface UsePositionProps {\n  options?: PositionOptions;\n  params: QueryParams | undefined;\n}\n\nconst defaultOptions: PositionOptions = {\n  enableHighAccuracy: true,\n};\n\nexport function usePosition({options}: UsePositionProps) {\n  const [watchId, setWatchId] = useState<number>();\n  const [position, setPosition] = useState<Position>();\n  const [error, setError] = useState<PositionError>();\n  const updatePosition = useCallback(() => {\n    if (typeof navigator !== 'undefined') {\n      navigator.geolocation.getCurrentPosition(\n        setPosition,\n        setError,\n        options || defaultOptions,\n      );\n    }\n  }, [options]);\n  useEffect(() => {\n    if (!watchId && typeof navigator !== 'undefined') {\n      const id = navigator.geolocation.watchPosition(\n        setPosition,\n        setError,\n        options || defaultOptions,\n      );\n\n      setWatchId(id);\n\n      return () => {\n        if (watchId) {\n          navigator.geolocation.clearWatch(watchId);\n\n          setWatchId(undefined);\n        }\n      };\n    }\n\n    return undefined;\n  }, [options, watchId]);\n  useDebugValue(\n    position\n      ? `[${position.coords.latitude}, ${position.coords.longitude}] @ ${moment(\n          position.timestamp,\n        ).fromNow()}`\n      : 'Loading...',\n  );\n\n  return {\n    error,\n    position,\n    updatePosition,\n  };\n}\n","import {Station} from 'models';\nimport {googleMapsAsync} from 'utilities/google';\nimport {Smoove} from './transform';\n\nenum StationSourceType {\n  Smoove,\n}\n\nexport type SourceName = 'vancouver' | 'test';\n\nexport interface StationSourceConfig {\n  location: google.maps.LatLngLiteral;\n  name: string;\n  options?: any;\n  type: keyof typeof StationSourceType;\n  uri: string;\n  cors?: boolean;\n}\n\nconst configMap = new Map<SourceName, StationSourceConfig>([\n  [\n    'test',\n    {\n      location: {\n        lat: 49.279627,\n        lng: -123.121116,\n      },\n      name: 'Test Data',\n      type: 'Smoove',\n      uri: '/test_data',\n    },\n  ],\n  [\n    'vancouver',\n    {\n      location: {\n        lat: 49.279627,\n        lng: -123.121116,\n      },\n      name: 'Mobi Bike Vancouver',\n      type: 'Smoove',\n      uri: 'http://vancouver-ca.smoove.pro/api-public/stations',\n      cors: true,\n    },\n  ],\n]);\n\nexport function getConfig(key: SourceName) {\n  const config = configMap.get(key);\n\n  if (!config) {\n    throw new Error(`No station data for source '${key}'`);\n  }\n\n  return config;\n}\n\nexport function getConfigByLocation(location: google.maps.LatLngLiteral) {\n  const google = googleMapsAsync(false);\n\n  return Array.from<StationSourceConfig>(configMap.values())\n    .map((config) => ({\n      config,\n      distance: google.maps.geometry.spherical.computeDistanceBetween(\n        new google.maps.LatLng(location),\n        new google.maps.LatLng(config.location.lat, config.location.lng),\n      ),\n    }))\n    .sort((left, right) => left.distance - right.distance)[0].config;\n}\n\nexport type StationSourceTransform = (response: any) => Station[];\n\nexport function mapTransform({type}: StationSourceConfig) {\n  switch (type) {\n    case 'Smoove':\n      return Smoove;\n    default:\n      throw new Error(`Invalid Configuration '${type}'`);\n  }\n}\n","import {createStation, StationData} from 'models';\n\nexport interface SmooveStation {\n  name: string;\n  coordinates: string;\n  // eslint-disable-next-line babel/camelcase\n  total_slots: number;\n  // eslint-disable-next-line babel/camelcase\n  free_slots: number;\n  // eslint-disable-next-line babel/camelcase\n  avl_bikes: number;\n  operative: boolean;\n  style: string;\n}\n\nexport interface Response {\n  result: SmooveStation[];\n}\n\nexport function parseLatLng({coordinates}: SmooveStation) {\n  try {\n    const match = /^\\s*(-?\\d+\\.\\d+)\\s*,\\s*(-?\\d+\\.\\d+)\\s*$/.exec(coordinates);\n\n    if (!match) {\n      throw new Error(`Unable to parse \"lat, lng\" from ${coordinates}`);\n    }\n\n    return {\n      lat: Number(match[1]),\n      lng: Number(match[2]),\n    };\n  } catch (error) {\n    return {\n      latLngError: error,\n    };\n  }\n}\n\nexport function parseNameAndNumber({name}: SmooveStation) {\n  try {\n    const match = /^(\\d+)\\s+(.*)$/.exec(name);\n\n    if (!match) {\n      throw new Error(`Unable to parse \"number name\" from ${name}`);\n    }\n\n    return {\n      name: match[2],\n      number: Number(match[1]),\n    };\n  } catch (error) {\n    return {\n      nameNumberError: error,\n    };\n  }\n}\n\nexport function create(smooveData: SmooveStation) {\n  const {nameNumberError, name, number} = parseNameAndNumber(smooveData);\n  const {lat, latLngError, lng} = parseLatLng(smooveData);\n  const data: StationData = {\n    ...smooveData,\n    bikes: smooveData.avl_bikes,\n    free: smooveData.free_slots,\n    lat,\n    lng,\n    name,\n    number,\n    operative: smooveData.operative,\n    total: smooveData.total_slots,\n    errors: [],\n  };\n\n  if (nameNumberError) {\n    data.errors.push(nameNumberError);\n  }\n\n  if (latLngError) {\n    data.errors.push(latLngError);\n  }\n\n  return createStation(data);\n}\n\nexport function Smoove({result}: Response) {\n  return result.map(create);\n}\n","export interface StationData extends Partial<google.maps.LatLngLiteral> {\n  bikes: number;\n  errors: any[];\n  free: number;\n  name: string | undefined;\n  number: number | undefined;\n  operative: boolean;\n  total: number;\n}\n\nexport interface Station extends StationData {\n  data: StationData;\n  valid?: boolean;\n}\n\nexport interface ValidStation extends Station {\n  lat: number;\n  lng: number;\n  name: string;\n  number: number;\n  valid: true;\n}\n\nexport function createStation(data: StationData): Station {\n  return {\n    data,\n    valid: [\n      Number.isInteger(data.bikes),\n      Number.isInteger(data.free),\n      Number.isInteger(data.total),\n      data.number != null && Number.isInteger(data.number) && data.number > 0,\n      data.lat != null && Number.isFinite(data.lat) && data.lat !== 0,\n      data.lng != null && Number.isFinite(data.lng) && data.lng !== 0,\n      data.name != null && /^\\w/.test(data.name),\n      data.errors.length === 0,\n    ].every((x) => x),\n    ...data,\n  };\n}\n","import fetch from 'isomorphic-fetch';\nimport moment from 'moment';\nimport {Station} from 'models';\nimport {\n  getConfig,\n  getConfigByLocation,\n  mapTransform,\n  SourceName,\n  StationSourceConfig,\n  StationSourceTransform,\n} from './config';\n\nexport interface StationSourceResult {\n  config: StationSourceConfig;\n  error?: any;\n  fetchedAt: moment.Moment;\n  stations: Station[];\n}\n\nexport interface Options {\n  debug?: boolean;\n}\n\nexport class StationSource {\n  public static create(\n    configOrKey: SourceName | StationSourceConfig,\n    {debug}: Options,\n  ) {\n    const config =\n      typeof configOrKey === 'string' ? getConfig(configOrKey) : configOrKey;\n\n    return new StationSource(config, mapTransform(config), debug);\n  }\n\n  public static nearest(location: google.maps.LatLngLiteral, options: Options) {\n    return StationSource.create(getConfigByLocation(location), options);\n  }\n\n  readonly config: StationSourceConfig;\n  readonly verboseOutput: boolean;\n  private readonly transform: StationSourceTransform;\n\n  constructor(\n    config: StationSourceConfig,\n    transform: StationSourceTransform,\n    // eslint-disable-next-line no-process-env\n    verboseOutput = process.env.NODE_ENV !== 'production',\n  ) {\n    this.config = config;\n    this.transform = transform;\n    this.verboseOutput = verboseOutput;\n  }\n\n  async getJSON() {\n    const uri = this.config.cors\n      ? `https://cors.io/?${this.config.uri}`\n      : this.config.uri;\n    this.debug(`Fetching stations from '${uri}' ...`);\n\n    const response = await fetch(uri, {\n      headers: this.config.options ? this.config.options.headers : undefined,\n    });\n\n    const json = response.json();\n\n    this.debug('Fetch Response', json);\n\n    return json;\n  }\n\n  async getStations(): Promise<StationSourceResult> {\n    try {\n      const json = await this.getJSON();\n\n      const stations = this.transform(json);\n\n      this.debug(`Fetched ${stations.length} stations`);\n\n      return {\n        config: this.config,\n        fetchedAt: moment(),\n        stations,\n      };\n    } catch (error) {\n      this.debug(`Fetch failed: ${error.message || 'Unknown Error'}`, error);\n\n      return {\n        config: this.config,\n        error,\n        fetchedAt: moment(),\n        stations: [],\n      };\n    }\n  }\n\n  protected debug(message: string, ...args: any[]) {\n    if (this.verboseOutput) {\n      // eslint-disable-next-line no-console\n      console.log(message, args);\n    }\n  }\n}\n","import {useCallback, useDebugValue, useEffect, useMemo, useState} from 'react';\nimport {SourceName, StationSource, StationSourceResult} from 'data';\nimport {QueryParams} from './useQueryParams';\n\ninterface UseStationsProps {\n  params: QueryParams | undefined;\n}\n\nexport const defaultSourceName: SourceName = 'vancouver';\n\nfunction getSourceName(params: QueryParams | undefined) {\n  if (!params) {\n    return {};\n  }\n\n  return {\n    debug: Boolean(params.get('debug')),\n    sourceName: (params.get('source') ||\n      (params.get('test') && 'test') ||\n      defaultSourceName) as SourceName,\n  };\n}\n\nexport function useStations({params}: UseStationsProps) {\n  const {debug, sourceName} = getSourceName(params);\n  const [stationSourceResult, setStationSourceResult] = useState<\n    StationSourceResult\n  >();\n  const source = useMemo(() => {\n    if (sourceName) {\n      return StationSource.create(sourceName, {debug});\n    }\n\n    return null;\n  }, [debug, sourceName]);\n  const updateStations = useCallback(() => {\n    if (source) {\n      return source.getStations().then(setStationSourceResult);\n    }\n\n    return undefined;\n  }, [source]);\n  useEffect(() => {\n    if (source) {\n      updateStations();\n    }\n  }, [source, updateStations]);\n  useDebugValue(\n    stationSourceResult\n      ? `${\n          stationSourceResult.stations.length\n        } stations loaded (${stationSourceResult.fetchedAt.fromNow()})`\n      : 'Loading...',\n  );\n\n  return {\n    stationSourceResult,\n    updateStations,\n  };\n}\n","/* eslint-disable */\n\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as {env: {[key: string]: string}}).env.PUBLIC_URL,\n      window.location.href,\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA',\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.',\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.',\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport {App} from './App';\nimport {unregister} from './serviceWorker';\n\nimport 'styles/_global.scss';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nunregister();\n","import React from 'react';\nimport {GoogleMapProvider} from '@googlemap-react/core';\nimport {Loader} from 'components';\nimport {Header, StationMap} from './components';\nimport {useQueryParams, usePosition, useStations} from './hooks';\n\nimport styles from './App.module.scss';\n\nexport function App() {\n  const {params} = useQueryParams();\n  const {position} = usePosition({params});\n  const {stationSourceResult, updateStations} = useStations({params});\n  return (\n    <div className={styles.Container}>\n      <Header />\n      <div className={styles.Content}>\n        {stationSourceResult ? (\n          <GoogleMapProvider>\n            <StationMap\n              fetchedAt={stationSourceResult.fetchedAt}\n              location={stationSourceResult.config.location}\n              stations={stationSourceResult.stations}\n              position={position}\n              updateStations={updateStations}\n            />\n          </GoogleMapProvider>\n        ) : (\n          <Loader />\n        )}\n      </div>\n    </div>\n  );\n}\n","import {useDebugValue, useEffect, useState} from 'react';\n\nexport type QueryParams = Map<string, string>;\n\nexport function useQueryParams() {\n  const [params, setParams] = useState<QueryParams>();\n  useEffect(() => {\n    if (typeof window !== 'undefined' && !params) {\n      const params = new Map<string, string>();\n\n      new URLSearchParams(window.location.search).forEach((value, key) => {\n        params.set(key.toLowerCase(), value);\n      });\n\n      setParams(params);\n    }\n  }, [params]);\n  useDebugValue(\n    typeof window === 'undefined' ? 'Loading...' : window.location.search,\n  );\n\n  return {\n    params,\n  };\n}\n"],"sourceRoot":""}