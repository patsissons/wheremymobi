(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{292:function(e,t,n){var o;e.exports=(o=n(546))&&o.default||o},310:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=n(153),i=n(317),c=n.n(i),s=n(335),l=["double-bounce","chasing-dots","circle","cube-grid"];var u=Object(a.a)(Object(a.h)(function(e){return{name:e.name||l[Math.floor(Math.random()*l.length)]}}))(function(e){var t=e.name;return Boolean(t)&&o.createElement("div",{className:s.LoadingContainer},o.createElement(c.a,{className:s.Loader,name:t}))}),f=Object(a.b)({mapsApiKey:"AIzaSyBXrYScIU6sWYUWLLlovYhzq-bLzwTgAoc"}),p=(n(195),n(32),n(70)),d=n.n(p),m=(n(71),n(34),n(238),n(196)),g=n.n(m),h=n(7),v=n.n(h),b=n(197),w=n(536),O=n.n(w),E=n(4),j=n.n(E),y=n(35),C=n(135),k=n(538),N=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).containerRef=o.createRef(),t}v()(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props.position,t=void 0===e?google.maps.ControlPosition.BOTTOM_CENTER:e;this.containerRef.current&&this.map.controls[t].push(this.containerRef.current)},n.componentWillUnmount=function(){var e=this.props.position,t=void 0===e?google.maps.ControlPosition.BOTTOM_CENTER:e;this.containerRef.current&&this.map.controls[t].removeAt(this.map.controls[t].getArray().indexOf(this.containerRef.current))},n.render=function(){var e=this.props.children;return Object(y.createPortal)(o.createElement("div",{className:k.Container,ref:this.containerRef},e),this.map.getDiv())},g()(t,[{key:"map",get:function(){return this.context[C.MAP]}}]),t}(o.PureComponent);N.contextTypes={[C.MAP]:E.object};var M=Object(a.a)()(N),S=n(539);var x=function(e){var t=e.onClick,n=d()(e,["onClick"]);return t?o.createElement("button",Object.assign({type:"button",onClick:t,className:S.Container},n)):o.createElement("div",Object.assign({className:S.Container},n))};var A=function(e){var t=e.color,n=void 0===t?"magenta":t,r=e.coords,a=(e.timestamp,d()(e,["color","coords","timestamp"])),i=r.accuracy,c=r.heading,s=r.latitude,l=r.longitude,u=new google.maps.LatLng(s,l);return o.createElement(o.Fragment,null,o.createElement(b.Circle,{center:u,radius:i,options:{fillColor:n,strokeColor:n,fillOpacity:.25,strokeWeight:1}}),o.createElement(b.Marker,Object.assign({icon:{anchor:new google.maps.Point(0,2.6),path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW,strokeColor:n,fillColor:n,fillOpacity:1,rotation:c,scale:10,strokeWeight:1},position:new google.maps.LatLng(s,l),zIndex:google.maps.Marker.MAX_ZINDEX},a)))},L='\n<svg width="100px" height="100px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">\n  <path id="bg" fill="#ffffff" d="m77.438,31.70225c-0.139,-5.802 -1.797,-10.248 -4.202,-14.012c-2.307,-3.607 -5.341,-6.666 -9.258,-8.958c-4.793,-2.803 -11.556,-4.639 -18.766,-3.553c-8.819,1.33 -15.391,6.39 -19.316,12.561c-2.385,3.752 -4.039,8.341 -4.152,14.062c-0.117,5.854 1.706,10.369 3.954,14.261c1.122,1.948 2.132,3.929 3.302,5.805c3.504,5.621 7.291,10.97 10.559,16.765c4.406,7.812 8.044,16.242 10.108,26.371c2.984,-15.367 9.802,-26.583 17.063,-37.58c2.439,-3.692 4.867,-7.382 6.806,-11.41c0.993,-2.063 2.107,-3.996 2.803,-6.306c0.684,-2.283 1.172,-5.035 1.099,-8.006z"/>\n  <path id="fill" fill="currentColor" d="M77.438,31.834c-0.139-5.802-1.797-10.248-4.202-14.012c-2.307-3.607-5.341-6.666-9.258-8.958   c-4.793-2.803-11.556-4.639-18.766-3.553c-8.819,1.33-15.391,6.39-19.316,12.561c-2.385,3.752-4.039,8.341-4.152,14.062   c-0.117,5.854,1.706,10.369,3.954,14.261C26.82,48.143,27.83,50.124,29,52c3.504,5.621,7.291,10.97,10.559,16.765   c4.406,7.812,8.044,16.242,10.108,26.371c2.984-15.367,9.802-26.583,17.063-37.58c2.439-3.692,4.867-7.382,6.806-11.41   c0.993-2.063,2.107-3.996,2.803-6.306C77.023,37.557,77.511,34.805,77.438,31.834z M49.685,52.47   c-11.004,0-19.923-8.92-19.923-19.923c0-11.002,8.919-19.922,19.923-19.922c11.003,0,19.923,8.92,19.923,19.922   C69.607,43.55,60.688,52.47,49.685,52.47z"/>\n</svg>'.trim();function I(e){return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(L.replace(/fill="currentColor"/,'fill="'+((t=e.bikes)>10?"forestgreen":t>5?"coral":"crimson")+'"'));var t}function R(e){return{url:I(e),labelOrigin:new google.maps.Point(49,33)}}var P=Object(a.a)(Object(a.g)({handleOnClick(e){var t=e.showInfo,n=e.node;return function(){return t(n)}}}))(function(e){var t=e.handleOnClick,n=(e.showInfo,e.node.station),r=d()(e,["handleOnClick","showInfo","node"]),a=n.lat,i=n.lng;return o.createElement(b.Marker,Object.assign({onClick:t,icon:R(n),label:{text:n.bikes+" | "+n.free,fontSize:"0.75rem",fontWeight:"bold"},position:new google.maps.LatLng(a,i)},r))}),T=function(e){function t(){return e.apply(this,arguments)||this}v()(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.container,n=e.position,o=void 0===n?google.maps.ControlPosition.BOTTOM_CENTER:n,r=this.context[C.MAP];r.controls[o].push(t),this.map=r},n.render=function(){var e=this.props,t=e.children,n=e.container;return Object(y.createPortal)(t,n)},t}(o.PureComponent);T.contextTypes={[C.MAP]:E.object};o.PureComponent,n(291),n(541);var U=function(e){var t=e.fetchedAt,n=e.station;return o.createElement("div",null,o.createElement("ul",null,o.createElement("li",null,"["+n.number.toString().padStart(4,"0")+"] "+n.name+(n.operative?"":" (CLOSED)")),o.createElement("li",null,n.bikes+" bikes / "+n.free+" slots ("+n.total+" total)"),o.createElement("li",null,o.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:"https://www.google.com/maps/dir/?api=1&travelmode=bicycling&destination="+n.lat+","+n.lng},n.lat+", "+n.lng)),o.createElement("li",null,"Last Updated: "+t.fromNow())))},D=n(544),B=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={followGps:!0},t.handleDrag=function(){t.setState({followGps:!1})},t.handleGpsCenter=function(){t.setState({followGps:!0})},t.renderInfo=function(){var e=t.props,n=e.fetchedAt,r=e.selectedNode;if(!r)return!1;var a=r.station,i=a.lat,c=a.lng;return o.createElement(b.InfoWindow,{position:{lat:i,lng:c},onCloseClick:t.props.hideInfo,options:{pixelOffset:new google.maps.Size(0,-100)}},o.createElement(U,{fetchedAt:n,station:r.station}))},t.renderMarker=function(e){if(!e.isValid)return console.debug("Bad Station Found",e.station),!1;var n=t.props.showInfo;return o.createElement(P,{key:e.station.number,node:e,showInfo:n})},t.renderMarkers=function(e){void 0===e&&(e=!0);var n=Array.from(t.props.nodes.values()).map(t.renderMarker);return e?o.createElement(O.a,{averageCenter:!0,enableRetinaIcons:!0,gridSize:60,maxZoom:17},n):n},t.renderPosition=function(){var e=t.props.position;return!!(e&&e.coords&&e.timestamp)&&o.createElement(A,{coords:e.coords,timestamp:e.timestamp})},t}return v()(t,e),t.prototype.render=function(){var e=this.props,t=e.hideInfo,n=e.defaultCenter,r=e.defaultZoom;return o.createElement(b.GoogleMap,{center:this.gpsCenter,defaultCenter:n,defaultZoom:r,onClick:t,onDrag:this.handleDrag,zoom:this.gpsZoom},o.createElement(b.BicyclingLayer,null),o.createElement(M,null,o.createElement(x,{onClick:this.handleGpsCenter},"GPS")),this.renderMarkers(),this.renderPosition(),this.renderInfo())},g()(t,[{key:"gpsCenter",get:function(){var e=this.props.position;if(this.state.followGps&&e&&e.coords){var t=e.coords,n=t.latitude,o=t.longitude;return new google.maps.LatLng(n,o)}}},{key:"gpsZoom",get:function(){var e=this.props.position;if(this.state.followGps&&e&&e.coords){var t=e.coords.accuracy;return Math.min(20,Math.max(1,Math.log2(591657550/t)-6))}}}]),t}(o.PureComponent),F=Object(a.a)(f,Object(a.b)({defaultCenter:{lat:49.279627,lng:-123.121116},defaultZoom:13}),Object(a.i)({},{showInfo:()=>(function(e){return{selectedNode:e}}),hideInfo:()=>(function(){return{selectedNode:void 0}})}),Object(a.h)(function(e){return{googleMapURL:"https://maps.googleapis.com/maps/api/js?key="+e.mapsApiKey+"&v=3.exp&libraries=geometry,drawing,places",loadingElement:o.createElement("div",{className:D.LoadingContainer},"Loading..."),containerElement:o.createElement("div",{className:D.MapContainer}),mapElement:o.createElement("div",{className:D.Map})}}),Object(a.d)(function(e){e.mapsApiKey;var t=e.nodes,n=d()(e,["mapsApiKey","nodes"]);return Object.assign({nodes:t.reduce(function(e,t){return e.set(t.station.number,t)},new Map)},n)}),b.withScriptjs,b.withGoogleMap)(B),_=n(545),z=(n(33),n(292),r.a.createContext({})),G=function(e){return r.a.createElement(z.Consumer,null,function(t){return e.data||t[e.query]&&t[e.query].data?(e.render||e.children)(e.data?e.data.data:t[e.query].data):r.a.createElement("div",null,"Loading (StaticQuery)")})};G.propTypes={data:j.a.object,query:j.a.string.isRequired,render:j.a.func,children:j.a.func};var q=n(547);var W=function(e){var t=e.description,n=e.logo,r=e.logoUrl;return o.createElement("div",{className:q.Header},o.createElement("div",{className:q.HeaderLogo},o.createElement("a",{href:r},o.createElement("img",{alt:"logo",src:n}))),o.createElement("div",{className:q.HeaderContent},o.createElement("h1",null,t)))},Z=n(548);var V="3229557108";var J=Object(a.a)(Object(a.b)({errors:[]}),Object(a.c)(function(e){var t=Object.assign({},e);return o.createElement(G,Object.assign({query:V},t,{data:_}))},function(e){return{site:e.site}}))(function(e){var t=e.errors,n=e.site.siteMetadata,r=n.description,a=n.logo,i=n.logoUrl,c=d()(e,["errors","site"]);return o.createElement("div",{className:Z.Container},o.createElement(W,{description:r,logo:a,logoUrl:i}),o.createElement("div",Object.assign({className:Z.Content},c)),0!==t.length&&o.createElement("div",null,t))}),H=(n(78),n(311)),K=n(147),Y=n(293),X=n(574),$=n(555),Q=n(576),ee=n(578),te=n(575),ne=n(549),oe=n.n(ne),re=n(554),ae=n(572),ie=n(577),ce=n(579),se=n(570),le=n(571),ue=n(573);n(550);var fe=function(){function e(e){this.station=e}return e.prototype.toString=function(){return this.isValid?"["+this.station.number+"] "+this.station.name+" ("+this.station.bikes+" | "+this.station.free+")":"INVALID"},g()(e,[{key:"isValid",get:function(){return[Number.isInteger(this.station.bikes),Number.isInteger(this.station.free),Number.isInteger(this.station.total),Number.isInteger(this.station.number),this.station.number>0,Number.isFinite(this.station.lat),0!==this.station.lat,Number.isFinite(this.station.lng),0!==this.station.lng,/^\w/.test(this.station.name),0===this.station.errors.length].every(function(e){return e})}}]),e}();n(551);function pe(e){var t=function(e){return void 0===e&&(e={}),Object.assign({data:null,errors:[],bikes:0,free:0,lat:0,lng:0,name:"",number:0,operative:!1,total:0},e)}({data:e,bikes:e.avl_bikes,free:e.free_slots,operative:e.operative,total:e.total_slots});return function(e,t){var n=e.name;try{var o=/^(\d+)\s+(.*)$/.exec(n);if(!o)throw new Error('Unable to parse "number name" from '+n);t.number=Number(o[1]),t.name=o[2]}catch(r){t.errors.push(r)}}(e,t),function(e,t){try{var n=/^\s*(-?\d+\.\d+)\s*,\s*(-?\d+\.\d+)\s*$/.exec(e);if(!n)throw new Error('Unable to parse "lat, lng" from '+e);t.lat=Number(n[1]),t.lng=Number(n[2])}catch(o){t.errors.push(o)}}(e.coordinates,t),t}var de,me=Object(Y.a)(function(e){return e.result.map(pe)});!function(e){e[e.Smoove=0]="Smoove"}(de||(de={}));var ge=new Map([["test",{location:{lat:49.279627,lng:-123.121116},name:"Test Data",type:"Smoove",uri:"/static_data"}],["vancouver",{location:{lat:49.279627,lng:-123.121116},name:"Mobi Bike Vancouver",type:"Smoove",uri:"http://vancouver-ca.smoove.pro/api-public/stations",cors:!0}]]);var he=function(){function e(e,t,n){void 0===n&&(n=!1),this.config=e,this.transform=t,this.verboseOutput=n}e.create=function(t,n){var o=n.debug,r="string"==typeof t?function(e){var t=ge.get(e.toLowerCase());if(!t)throw new Error("No station data for source '"+e+"'");return t}(t):t;return new e(r,function(e){var t=e.type;switch(t){case"Smoove":return me;default:throw new Error("Invalid Configuration '"+t+"'")}}(r),o)},e.nearest=function(t,n){return e.create(function(e){return Array.from(ge.values()).map(function(t){return{config:t,distance:google.maps.geometry.spherical.computeDistanceBetween(e,new google.maps.LatLng(t.location.lat,t.location.lng))}}).sort(function(e,t){return e.distance-t.distance})[0].config}(t),n)};var t=e.prototype;return t.getJSON=function(){var e=this.config.cors?"https://cors.io/?"+this.config.uri:this.config.uri;this.debug("Fetching stations from '"+e+"' ...");var t=this.config.options?this.config.options.headers:void 0;return ce.a.getJSON(e,t)},t.getStations=function(e){var t=this;return(e||this.getJSON()).pipe(Object(se.a)(function(e){t.debug("Fetch Response",e)}),this.transform,Object(Y.a)(function(e){return t.debug("Fetched "+e.length+" stations"),{config:t.config,nodes:e.map(function(e){return new fe(e)}),fetchedAt:oe()()}}),Object(le.a)(function(e){return void 0===e&&(e={}),t.debug("Fetch failed: "+(e.message||"Unknown Error"),e),Object(re.a)({error:e,config:t.config,fetchedAt:oe()(),nodes:[]})}))},t.watchStations=function(e,t,n){var o=this;return void 0===e&&(e=Object(re.a)(!0)),void 0===t&&(t=300),Object(ae.a)(Object(ie.a)(0,1e3*t),e).pipe(Object(ue.a)(100),Object($.a)(function(){return o.getStations(n)}))},t.debug=function(e){if(this.verboseOutput){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];console.log(e,n)}},e}(),ve=n(556);function be(){if("undefined"==typeof window)return null;var e=new Map;return new URLSearchParams(window.location.search).forEach(function(t,n){e.set(n.toLowerCase(),t)}),e}Object(a.f)({fromESObservable:H.a});var we=Object(a.h)(function(){return{params:be()}});var Oe=Object(a.a)(we,function(e){void 0===e&&(e={enableHighAccuracy:!0});var t=new ve.Subject,n=function(){return t.next()};return Object(a.e)(function(t){return t.pipe(Object(Y.a)(function(){return"undefined"!=typeof navigator&&navigator.geolocation}),Object(X.a)(function(e){return Boolean(e)}),Object($.a)(function(t){return new K.a(function(n){t.watchPosition(function(e){n.next(e)},function(e){n.error({error:e})},e)})}),Object(Q.a)(void 0),Object(ee.a)(t,function(e,t){return console.log("[position]",e,t),Object.assign({},t,{reload:n,position:e})}))})}(),function(e){void 0===e&&(e="vancouver");var t=new ve.Subject,n=function(){console.log("reload"),t.next()};return Object(a.e)(function(o){return o.pipe(Object(Y.a)(function(e){return e.params}),Object(X.a)(function(e){return null!=e}),Object(Y.a)(function(t){return{debug:Boolean(t.get("debug")),source:t.get("source")||t.get("test")&&"test"||e}}),Object(te.a)(function(e,t){return e.debug===t.debug&&e.source===t.source}),Object($.a)(function(e){var n=e.debug,o=e.source;return console.log("fetch",{source:o,debug:n}),he.create(o,{debug:n}).watchStations(t)}),Object(ee.a)(o,function(e,t){return console.log("[stations]",e,t),Object.assign({},t,{reload:n,stations:e})}))})}())(function(e){var t=e.position,n=e.reload,r=e.stations;return o.createElement(J,null,r?o.createElement(F,{fetchedAt:r.fetchedAt,location:r.config.location,nodes:r.nodes,position:t,reload:n}):o.createElement(u,null))}),Ee=n(568);var je=function(){return o.createElement("div",{className:Ee.Container},o.createElement("h1",null,"NOT FOUND"),o.createElement("p",null,"You just hit a route that doesn't exist... the sadness."))};n.d(t,"a",function(){return Oe}),n.d(t,"b",function(){return je})},545:function(e){e.exports={data:{site:{siteMetadata:{description:"Find mobi bikes in Vancouver, BC.",logo:"https://www.mobibikes.ca/sites/all/themes/smoove_bootstrap/logo.png",logoUrl:"https://www.mobibikes.ca/en#the-map"}}}}},546:function(e,t,n){"use strict";n.r(t);n(32);var o=n(0),r=n.n(o),a=n(4),i=n.n(a),c=n(66),s=n(2),l=function(e){var t=e.location,n=s.default.getResourcesForPathnameSync(t.pathname);return r.a.createElement(c.a,Object.assign({location:t,pageResources:n},n.json))};l.propTypes={location:i.a.shape({pathname:i.a.string.isRequired}).isRequired},t.default=l}}]);
//# sourceMappingURL=2-0d13098ecfe22b89e42a.js.map